import{d as R,o as Y,K as d,e,b as o,w as l,L as x,M as C,y as n,N as E,r,a8 as I,f as O,X as P,a as i,c as A,u as v,n as S,V as L,Z as H,x as h,aI as J,$ as K,a4 as T,ac as X,z as Z,a7 as q,a5 as G}from"./index-DK81lzkh.js";/* empty css                   *//* empty css                  *//* empty css                  */import{p as Q,a as k}from"./index-BL4ylxUb.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ee={class:"scripts-page"},ae={class:"page-header"},te={class:"header-actions"},se={class:"content-card"},oe={class:"scripts-list"},le={class:"script-icon"},ne={class:"script-info"},ie={class:"script-name"},ce={class:"script-meta"},de={class:"meta-tag framework-tag"},re={class:"meta-date"},ue={class:"script-actions"},_e={key:0,class:"empty-state"},pe={key:0,class:"script-info-dialog"},ve={class:"info-header"},me={class:"info-item"},fe={class:"info-value"},ge={class:"info-item"},ye={class:"info-value"},we={class:"info-item"},he={class:"info-value"},ke={class:"code-editor"},be=R({__name:"Manage",setup(Ve){const g=r(!1),m=r([]),b=r([]),u=r(""),y=r(!1),c=r(null),M={draft:"草稿",reviewed:"已审核",approved:"已通过"},B=s=>M[s]||s,U=s=>T(s).format("YYYY-MM-DD HH:mm"),$=async()=>{try{b.value=await Q.list()}catch(s){console.error("Failed to load projects:",s)}},V=async()=>{if(!u.value){m.value=[];return}g.value=!0;try{m.value=await k.list({project_id:u.value})}catch(s){console.error("Failed to load scripts:",s)}finally{g.value=!1}},z=s=>{c.value=s,y.value=!0},D=async s=>{try{const a=await k.download(s.id),f=window.URL.createObjectURL(a),_=document.createElement("a");_.href=f,_.download=`${s.name}.${s.language==="python"?"py":"java"}`,_.click(),window.URL.revokeObjectURL(f)}catch(a){console.error("Failed to download:",a)}},F=async s=>{try{await q.confirm("确定要删除该脚本吗？","提示",{type:"warning"}),await k.delete(s.id),G.success("删除成功"),V()}catch(a){a!=="cancel"&&console.error("Failed to delete:",a)}};return Y(async()=>{await $()}),(s,a)=>{const f=X,_=I,p=O,w=Z,N=P;return i(),d("div",ee,[e("div",ae,[a[2]||(a[2]=e("div",{class:"header-content"},[e("h1",{class:"page-title"},"测试脚本管理"),e("p",{class:"page-subtitle"},"管理自动化测试脚本")],-1)),e("div",te,[o(_,{modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=t=>u.value=t),placeholder:"选择项目",class:"project-select",clearable:"",onChange:V},{default:l(()=>[(i(!0),d(x,null,C(b.value,t=>(i(),A(f,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),e("div",se,[e("div",oe,[(i(!0),d(x,null,C(m.value,t=>(i(),d("div",{key:t.id,class:"script-item"},[e("div",le,[o(p,null,{default:l(()=>[o(v(S))]),_:1})]),e("div",ne,[e("div",ie,n(t.name),1),e("div",ce,[e("span",{class:L(["meta-tag lang-tag",t.language])},n(t.language==="python"?"Python":"Java"),3),e("span",de,n(t.framework),1),e("span",re,n(U(t.created_at)),1)])]),e("div",{class:L(["script-status",t.status])},n(B(t.status)),3),e("div",ue,[o(w,{type:"primary",text:"",size:"small",onClick:j=>z(t)},{default:l(()=>[o(p,null,{default:l(()=>[o(v(H))]),_:1}),a[3]||(a[3]=h(" 查看 ",-1))]),_:1},8,["onClick"]),o(w,{type:"success",text:"",size:"small",onClick:j=>D(t)},{default:l(()=>[o(p,null,{default:l(()=>[o(v(J))]),_:1}),a[4]||(a[4]=h(" 下载 ",-1))]),_:1},8,["onClick"]),o(w,{type:"danger",text:"",size:"small",onClick:j=>F(t)},{default:l(()=>[o(p,null,{default:l(()=>[o(v(K))]),_:1}),a[5]||(a[5]=h(" 删除 ",-1))]),_:1},8,["onClick"])])]))),128)),!g.value&&m.value.length===0?(i(),d("div",_e,[o(p,null,{default:l(()=>[o(v(S))]),_:1}),e("p",null,n(u.value?"暂无测试脚本":"请先选择项目"),1)])):E("",!0)])]),o(N,{modelValue:y.value,"onUpdate:modelValue":a[1]||(a[1]=t=>y.value=t),title:"脚本详情",width:"900px",top:"5vh",class:"dark-dialog"},{default:l(()=>[c.value?(i(),d("div",pe,[e("div",ve,[e("div",me,[a[6]||(a[6]=e("span",{class:"info-label"},"脚本名称",-1)),e("span",fe,n(c.value.name),1)]),e("div",ge,[a[7]||(a[7]=e("span",{class:"info-label"},"语言",-1)),e("span",ye,n(c.value.language),1)]),e("div",we,[a[8]||(a[8]=e("span",{class:"info-label"},"框架",-1)),e("span",he,n(c.value.framework),1)])]),e("div",ke,[e("pre",null,[e("code",null,n(c.value.content),1)])])])):E("",!0)]),_:1},8,["modelValue"])])}}}),Me=W(be,[["__scopeId","data-v-2afb44f0"]]);export{Me as default};
