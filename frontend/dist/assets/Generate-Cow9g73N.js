import{an as us,r as k,d as rs,o as ds,J as ps,ao as cs,K as w,e as o,L as Y,M as ee,ap as ye,aq as ge,b as t,w as s,N as G,y as p,ar as vs,x as u,c as V,a3 as Se,F as te,f as fs,a0 as ms,ak as _s,ai as ys,as as gs,z as ks,a9 as bs,at as ws,au as xs,X as Cs,a5 as f,a as d,V as K,u as c,ad as Q,a1 as Fs,a8 as Ts,av as Vs,aw as js,aj as Is,ax as Ss,k as ke,Z as Le,aa as Es,$ as Ne,ay as Ps,a2 as Ds,az as Us,m as ie,C as at,aA as Be,aB as Me,aC as Ge,_ as $s,ae as be,aD as zs,aE as As,aF as hs,ab as Rs,aG as qs,aH as Ls,ah as Ns,am as Bs,ag as Ms,ac as Gs,l as Os,a6 as Hs,a7 as Oe}from"./index-DK81lzkh.js";/* empty css                   *//* empty css                             *//* empty css                  *//* empty css                    *//* empty css                 *//* empty css                  */import{p as H,d as ue,f as re,t as Js,g as we}from"./index-BL4ylxUb.js";import{_ as Ks}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Xs=us("generate",()=>{const j=k(null),se=k([]),g=k({projectId:"",currentStep:0,testTypes:["functional"],userRequirements:"",existingDocuments:[],existingFunctionPoints:[],generatedFunctionPoints:[],generatedTestCases:[],savedFpIds:[],uploadedDocs:[],fileList:[]}),xe=(C,P)=>{const q={id:`${C}_${Date.now()}`,type:C,status:"running",progress:0,message:"正在初始化...",projectId:P,startTime:Date.now()};return j.value=q,W(),q},b=(C,P)=>{j.value&&(j.value.progress=C,j.value.message=P,W())},X=C=>{j.value&&(j.value.status="completed",j.value.progress=100,j.value.result=C,se.value.unshift(j.value),W())},A=C=>{j.value&&(j.value.status="failed",j.value.error=C,se.value.unshift(j.value),W())},de=()=>j.value&&j.value.status==="running"?!1:(j.value=null,W(),!0),z=C=>{g.value={...g.value,...C},W()},x=()=>{try{const C=localStorage.getItem("generate_state");if(C){const P=JSON.parse(C);g.value={...g.value,...P.savedState},P.currentTask&&P.currentTask.status==="running"&&(j.value=P.currentTask)}}catch(C){console.error("Failed to load state:",C)}return g.value},W=()=>{try{localStorage.setItem("generate_state",JSON.stringify({currentTask:j.value,savedState:g.value,taskHistory:se.value.slice(0,10)}))}catch(C){console.error("Failed to save state:",C)}};return{currentTask:j,taskHistory:se,savedState:g,startTask:xe,updateTask:b,completeTask:X,failTask:A,clearTask:de,saveState:z,loadState:x,clearState:()=>{g.value={projectId:"",currentStep:0,testTypes:["functional"],userRequirements:"",existingDocuments:[],existingFunctionPoints:[],generatedFunctionPoints:[],generatedTestCases:[],savedFpIds:[],uploadedDocs:[],fileList:[]},j.value=null,localStorage.removeItem("generate_state")}}}),Ws={class:"generate-page"},Zs={class:"steps-container"},Qs=["onClick"],Ys={class:"step-icon"},el={key:1},tl={class:"step-title"},sl={key:0,class:"step-line"},ll={class:"content-card"},al={class:"step-content"},ol={class:"step-panel"},nl={key:0,class:"project-stats"},il={class:"step-panel"},ul={key:0,class:"existing-docs"},rl={class:"document-list"},dl={class:"doc-icon"},pl={class:"doc-info"},cl={class:"doc-name"},vl={class:"doc-meta"},fl={class:"meta-tag"},ml={class:"meta-size"},_l={class:"meta-date"},yl={class:"doc-actions"},gl={class:"step-panel"},kl={key:0,class:"generating"},bl={key:1},wl={class:"fp-header"},xl={class:"fp-actions"},Cl={key:0,class:"empty-hint"},Fl={key:1,class:"function-point-list"},Tl={class:"fp-info"},Vl={class:"fp-name"},jl={class:"fp-meta"},Il={class:"meta-tag"},Sl={class:"meta-priority"},El={class:"meta-module"},Pl={class:"fp-actions"},Dl={class:"step-panel"},Ul={class:"review-header"},$l={class:"batch-actions",style:{"margin-top":"16px"}},zl={key:0,class:"function-point-list",style:{"margin-top":"16px"}},Al={class:"fp-info"},hl={class:"fp-name"},Rl={class:"fp-meta"},ql={class:"meta-tag"},Ll={class:"meta-priority"},Nl={class:"meta-module"},Bl={class:"fp-actions"},Ml={class:"review-actions"},Gl={class:"step-panel"},Ol={key:0,class:"generating-container"},Hl={class:"pulse-loader"},Jl={class:"loader-icon"},Kl={class:"progress-info"},Xl={class:"progress-percentage"},Wl={class:"progress-status"},Zl={class:"progress-bar-wrapper"},Ql={class:"generation-details"},Yl={class:"detail-text"},ea={key:1,class:"generated-content"},ta={class:"info-alert"},sa={class:"alert-icon"},la={class:"alert-content"},aa={class:"action-bar"},oa={class:"action-left"},na={class:"list-count"},ia={class:"action-right"},ua={key:0,class:"empty-state"},ra={class:"empty-icon"},da={key:1,class:"testcase-list"},pa={class:"testcase-info"},ca={class:"testcase-title"},va={class:"testcase-meta"},fa={class:"meta-tag"},ma={class:"meta-priority"},_a={class:"testcase-actions"},ya={key:2,class:"final-review-section"},ga={class:"review-summary"},ka={class:"summary-stats"},ba={class:"stat-item"},wa={class:"stat-icon total"},xa={class:"stat-number"},Ca={class:"stat-item"},Fa={class:"stat-icon approved"},Ta={class:"stat-number"},Va={class:"stat-item"},ja={class:"stat-icon pending"},Ia={class:"stat-number"},Sa={class:"review-actions"},Ea={key:0,class:"step-actions"},Pa={key:0,class:"test-steps"},Da={class:"steps-list"},Ua={class:"step-number"},$a={class:"step-content"},za={class:"step-action"},Aa={key:0,class:"step-expected"},ha={key:1,class:"no-steps"},Ra={class:"dialog-footer-actions"},qa=rs({__name:"Generate",setup(j){const se=Hs(),g=Xs(),xe=["选择项目","上传文档","生成功能点","审核确认","生成用例"],b=k(0),X=k(!1),A=k(!1),de=k(!1),z=k(""),x=k(0),W=k([]),U=k(null),C=k([]),P=k([]),q=k([]),pe=k([]),$=k([]),I=k([]),N=k([]),v=Se({projectId:"",testTypes:["functional"],userRequirements:""}),ce=k(!1),ve=k(""),Ee=k(!1),Pe=k(null),He=k(-1),fe=k(!1),S=Se({name:"",description:"",test_type:"functional",priority:"p2",module:"",acceptance_criteria:""}),me=k(!1),E=Se({title:"",description:"",test_type:"functional",priority:"p2",preconditions:"",expected_results:""}),Ce=k(!1),D=k(null),Fe=k(!1),B=k(null),Te=k(!1),De=k(!1),Ue=k(""),$e=k(),T=Se({name:"",description:"",test_type:"functional",priority:"p2",module:"",acceptance_criteria:""}),ot={name:[{required:!0,message:"请输入功能点名称",trigger:"blur"}],test_type:[{required:!0,message:"请选择测试类型",trigger:"change"}],priority:[{required:!0,message:"请选择优先级",trigger:"change"}]},M=te(()=>{const l=q.value.map(m=>({...m,isExisting:!0,isNew:!1,editing:!1})),e=$.value.map(m=>({...m,isExisting:!1,isNew:!0,status:m.status||"pending"})),i=[...l,...e],n=[],y=new Set;for(const m of i){const O=m.name.trim().toLowerCase();y.has(O)||(y.add(O),n.push(m))}return n}),ze=te(()=>M.value.filter(l=>l.status==="approved").length),Ae=te(()=>M.value.filter(l=>l.status==="pending").length),he=te(()=>I.value.filter(l=>l.status==="approved").length),Je=te(()=>I.value.filter(l=>!l.status||l.status==="draft").length),nt=te(()=>{switch(b.value){case 0:return v.projectId!=="";case 1:return C.value.length>0||v.userRequirements.trim()!==""||P.value.length>0;case 2:return M.value.length>0;default:return!0}}),it={functional:"功能测试",performance:"性能测试",security:"安全测试",reliability:"可靠性测试"},ut={functional:"primary",performance:"warning",security:"danger",reliability:"info"},rt={p0:"danger",p1:"warning",p2:"primary",p3:"info",p4:"info"},dt={draft:"待审核",reviewed:"已审核",approved:"已通过",rejected:"已拒绝"},pt={requirement:"需求文档",spec:"规格说明书",design:"设计文档",api:"接口说明",manual:"用户手册",image:"图片"},ct={pending:"待解析",processing:"解析中",parsed:"已解析",failed:"解析失败"},_e=l=>it[l]||l,vt=l=>ut[l]||"info",ft=l=>rt[l]||"info",Ke=l=>dt[l]||"待审核",mt=l=>pt[l]||l||"文档",_t=l=>ct[l]||l,yt=l=>l?new Date(l).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-",gt=async()=>{try{W.value=await H.list()}catch(l){console.error("Failed to load projects:",l)}},kt=async l=>{if(l){P.value=[],q.value=[],$.value=[],I.value=[],N.value=[],U.value=null;try{await le(),await ae(),await Re();const e=await H.stats(l);U.value=e}catch(e){console.error("Failed to load project data:",e)}}},le=async()=>{if(v.projectId)try{const l=await ue.list({project_id:v.projectId});P.value=l||[]}catch(l){console.error("Failed to load documents:",l)}},ae=async()=>{if(v.projectId)try{const l=await re.list({project_id:v.projectId});q.value=l||[],$.value=[]}catch(l){console.error("Failed to load function points:",l)}},bt=(l,e)=>{C.value=e},wt=(l,e)=>{C.value=e},xt=l=>l?l<1024?l+" B":l<1024*1024?(l/1024).toFixed(1)+" KB":(l/(1024*1024)).toFixed(1)+" MB":"-",Ct=l=>{f.info("文档预览功能开发中")},Ft=async l=>{try{await ue.parse(l.id),f.success("文档重新解析成功"),await le()}catch(e){console.error("Failed to reparse document:",e),f.error("重新解析失败")}},Tt=async l=>{try{await Oe.confirm(`确定要删除文档「${l.name}」吗？`,"删除确认",{type:"warning"}),await ue.delete(l.id),f.success("删除成功"),await le();const e=await H.stats(v.projectId);U.value=e}catch(e){e!=="cancel"&&console.error("Failed to delete document:",e)}},Vt=()=>{b.value>0&&b.value--},jt=async()=>{b.value===1?await It():b.value++},It=async()=>{if(C.value.length===0){b.value++;return}X.value=!0,z.value="正在上传文档...",x.value=0;try{const l=C.value.length;for(let n=0;n<l;n++){const y=C.value[n];x.value=Math.round(n/l*50),z.value=`正在上传文档 (${n+1}/${l}): ${y.name}`;const m=await ue.upload(v.projectId,y.raw);pe.value.push(m),z.value=`正在解析文档: ${m.name}`,x.value=Math.round(n/l*50)+25,await ue.parse(m.id),x.value=Math.round((n+1)/l*100)}const e=await ue.list({project_id:v.projectId});P.value=e.filter(n=>n.status==="parsed");const i=await H.stats(v.projectId);U.value=i,f.success("文档上传并解析成功"),b.value++}catch(l){console.error("Failed to upload documents:",l),f.error("文档上传失败")}finally{X.value=!1,x.value=0}},St=async l=>{if(!v.projectId&&l>0){f.warning("请先选择项目");return}b.value=l,l===1?await le():l===2||l===3?await ae():l===4&&await Re()},Re=async()=>{if(v.projectId)try{const l=await Js.list({project_id:v.projectId});I.value=l}catch(l){console.error("Failed to load test cases:",l)}},Xe=async()=>{if(!v.userRequirements.trim()&&P.value.length===0&&pe.value.length===0){f.warning("请先上传文档或输入需求描述");return}A.value=!0,z.value="正在分析需求...",x.value=10;try{const l=[...P.value,...pe.value].map(n=>n.id);z.value="正在检索文档知识库...",x.value=30,z.value="正在调用AI生成功能点...",x.value=50;const e=await we.generateFunctionPoints({project_id:v.projectId,document_ids:l,test_types:v.testTypes,user_requirements:v.userRequirements});if(x.value=90,!e.success){f.error(e.message||"功能点生成失败");return}const i=e.function_points.map(n=>({...n,project_id:v.projectId,editing:!1,status:n.status||"pending",originalData:{...n}}));$.value=[...$.value,...i],x.value=100,f.success(`成功生成 ${i.length} 个功能点`),await ae()}catch(l){console.error("Failed to generate function points:",l),f.error("功能点生成失败")}finally{A.value=!1,x.value=0}},Et=()=>{if(M.value.length===0){f.warning("请先添加功能点");return}b.value=3},Pt=async()=>{var i,n;const l=$.value.filter(y=>y.status==="approved"),e=q.value.filter(y=>y.status==="approved");if(console.log("approvedNewFps:",l),console.log("approvedExistingFps:",e),l.length===0&&e.length===0){f.warning("请至少审核通过一个功能点");return}X.value=!0,z.value="正在处理功能点...",x.value=20;try{if(N.value=[],l.length>0){z.value="正在保存新功能点...",x.value=40;const m=l.map(J=>({project_id:v.projectId,name:J.name,description:J.description,test_type:J.test_type,priority:J.priority,module:J.module,acceptance_criteria:J.acceptance_criteria}));console.log("newFpsToSave:",m);const O=await we.saveFunctionPoints(m);if(console.log("saveResult:",O),!O.success){f.error(O.message||"功能点保存失败");return}N.value=O.function_points.map(J=>J.id)}const y=e.map(m=>m.id);N.value=[...N.value,...y],x.value=100,f.success(`已确认 ${N.value.length} 个功能点`),b.value=4}catch(y){console.error("Failed to confirm function points:",y);const m=((n=(i=y==null?void 0:y.response)==null?void 0:i.data)==null?void 0:n.detail)||(y==null?void 0:y.message)||"功能点确认失败";f.error(m)}finally{X.value=!1,x.value=0}},We=async()=>{var e,i;console.log("savedFpIds:",N.value),console.log("existingFunctionPoints:",q.value);let l=[...N.value];if(l.length===0&&q.value.length>0){const n=q.value.filter(y=>y.status==="approved"||y.status==="pending");console.log("approvedFps from existing:",n),n.length>0&&(await Oe.confirm(`检测到该项目已有 ${n.length} 个功能点，是否使用这些功能点生成测试用例？`,"使用已有功能点",{confirmButtonText:"使用已有功能点",cancelButtonText:"取消",type:"info"}),l=n.map(y=>y.id))}if(console.log("fpIdsToUse:",l),l.length===0){f.warning("请先确认功能点或确保项目已有功能点");return}A.value=!0,z.value="正在生成测试用例...",x.value=10,g.startTask("test_cases",v.projectId),g.updateTask(10,"正在初始化...");try{x.value=30,z.value=`正在为 ${l.length} 个功能点生成测试用例...`,g.updateTask(30,`正在为 ${l.length} 个功能点生成测试用例...`),Ve();const n=await we.generateTestCases({project_id:v.projectId,function_point_ids:l});if(x.value=80,g.updateTask(80,"正在处理生成结果..."),!n.success){g.failTask(n.message||"测试用例生成失败"),f.error(n.message||"测试用例生成失败");return}if(!n.test_cases||n.test_cases.length===0){g.failTask("AI未能生成测试用例"),f.warning("AI未能生成测试用例，请检查功能点内容或稍后重试");return}const y=n.test_cases.map(m=>({...m,project_id:v.projectId}));I.value=[...I.value,...y],x.value=100,g.completeTask(y),f.success(`成功生成 ${y.length} 个测试用例`)}catch(n){console.error("Failed to generate test cases:",n);const y=((i=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:i.detail)||(n==null?void 0:n.message)||"测试用例生成失败";g.failTask(y),f.error(y)}finally{A.value=!1,x.value=0,Ve()}},Dt=async()=>{const l=I.value.filter(e=>e.status==="approved");if(l.length===0){f.warning("请先审核通过测试用例");return}de.value=!0;try{const e=await we.saveTestCases(l);if(!e.success){f.error(e.message||"测试用例保存失败");return}f.success(`成功保存 ${l.length} 个测试用例`);const i=await H.stats(v.projectId);U.value=i,I.value=I.value.filter(n=>n.status!=="approved"),Oe.confirm("测试用例已保存成功，是否前往用例管理页面查看？","提示",{confirmButtonText:"前往查看",cancelButtonText:"继续生成",type:"success"}).then(()=>{se.push("/test-cases")}).catch(()=>{et()})}catch(e){console.error("Failed to save test cases:",e),f.error("测试用例保存失败")}finally{de.value=!1}},Ut=l=>{l.status="approved",f.success("测试用例审核通过")},$t=l=>{l.status="rejected",f.success("测试用例已拒绝")},zt=()=>{for(const l of I.value)(!l.status||l.status==="draft")&&(l.status="approved");f.success("已全部审核通过")},At=l=>{De.value=!0,Ue.value=l.id,T.name=l.name,T.description=l.description||"",T.test_type=l.test_type||"functional",T.priority=l.priority||"p2",T.module=l.module||"",T.acceptance_criteria=l.acceptance_criteria||"",Te.value=!0},ht=l=>{At(l)},Rt=async()=>{$e.value&&await $e.value.validate(async l=>{var e,i;if(l)try{const n={...T,project_id:v.projectId,status:"pending"};await re.update(Ue.value,n),f.success("更新成功，状态已重置为待审核"),Te.value=!1,await ae()}catch(n){console.error("Failed to update function point:",n),f.error(((i=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:i.detail)||"更新失败")}})},qt=()=>{T.name="",T.description="",T.test_type="functional",T.priority="p2",T.module="",T.acceptance_criteria="",Ue.value="",De.value=!1},Ze=async l=>{try{await re.approve(l.id),l.status="approved",f.success("功能点审核通过");const e=await H.stats(v.projectId);U.value=e}catch(e){console.error("Failed to approve:",e),f.error("审核失败")}},Qe=async l=>{try{await re.reject(l.id),l.status="rejected",f.success("功能点已拒绝");const e=await H.stats(v.projectId);U.value=e}catch(e){console.error("Failed to reject:",e),f.error("操作失败")}},Lt=async l=>{l.isExisting?await Ze(l):(l.status="approved",f.success("功能点审核通过"))},Nt=async l=>{l.isExisting?await Qe(l):(l.status="rejected",f.success("功能点已拒绝"))},Ye=async(l,e)=>{if(l.isExisting)e==="approved"?await Ze(l):await Qe(l);else{const i=$.value.findIndex(n=>n.name===l.name&&n.test_type===l.test_type);i!==-1&&($.value[i].status=e,l.status=e,f.success(e==="approved"?"功能点审核通过":"功能点已拒绝"))}},Bt=async()=>{for(const e of M.value)if(e.status==="pending")if(e.isExisting)try{await re.approve(e.id),e.status="approved"}catch(i){console.error("Failed to approve:",i)}else{const i=$.value.findIndex(n=>n.name===e.name&&n.test_type===e.test_type);i!==-1&&($.value[i].status="approved")}const l=await H.stats(v.projectId);U.value=l,f.success("已全部审核通过")},Mt=async()=>{for(const e of M.value)if(e.status==="pending")if(e.isExisting)try{await re.reject(e.id),e.status="rejected"}catch(i){console.error("Failed to reject:",i)}else{const i=$.value.findIndex(n=>n.name===e.name&&n.test_type===e.test_type);i!==-1&&($.value[i].status="rejected")}const l=await H.stats(v.projectId);U.value=l,f.success("已全部拒绝")},Gt=l=>{B.value=l,Fe.value=!0},Ot=l=>{Pe.value=l,He.value=$.value.indexOf(l),ve.value="",ce.value=!0},Ht=async()=>{if(!ve.value.trim()){f.warning("请输入优化建议");return}Ee.value=!0;try{const l=await we.refineFunctionPoint({function_point:Pe.value,user_feedback:ve.value,project_id:v.projectId});if(!l.success){f.error(l.message||"优化失败");return}Object.assign($.value[He.value],l.function_point),ce.value=!1,f.success("功能点优化成功")}catch(l){console.error("Failed to refine:",l),f.error("优化失败")}finally{Ee.value=!1}},Jt=()=>{S.name="",S.description="",S.test_type="functional",S.priority="p2",S.module="",S.acceptance_criteria="",fe.value=!0},Kt=()=>{if(!S.name.trim()){f.warning("请输入功能点名称");return}$.value.push({...S,project_id:v.projectId,editing:!1}),fe.value=!1,f.success("功能点添加成功")},Xt=()=>{E.title="",E.description="",E.test_type="functional",E.priority="p2",E.preconditions="",E.expected_results="",me.value=!0},Wt=()=>{if(!E.title.trim()){f.warning("请输入测试用例标题");return}I.value.push({...E,project_id:v.projectId,test_steps:[],test_category:"functional"}),me.value=!1,f.success("测试用例添加成功")},Zt=l=>{D.value=l,Ce.value=!0},Qt=()=>{D.value&&(D.value.status="approved",f.success("测试用例审核通过"))},Yt=()=>{D.value&&(D.value.status="rejected",f.success("测试用例已拒绝"))},es=te(()=>A.value?`正在为 ${N.value.length||q.value.length} 个功能点生成测试用例...`:""),ts=l=>{I.value.splice(l,1)},et=()=>{b.value=0,v.projectId="",v.testTypes=["functional"],v.userRequirements="",C.value=[],P.value=[],q.value=[],pe.value=[],$.value=[],I.value=[],N.value=[],U.value=null,g.clearState()},Ve=()=>{g.saveState({projectId:v.projectId,currentStep:b.value,testTypes:v.testTypes,userRequirements:v.userRequirements,existingDocuments:P.value,existingFunctionPoints:q.value,generatedFunctionPoints:$.value,generatedTestCases:I.value,savedFpIds:N.value,uploadedDocs:pe.value,fileList:C.value})},ss=async()=>{const l=g.loadState();if(l.projectId&&(v.projectId=l.projectId,v.testTypes=l.testTypes||["functional"],v.userRequirements=l.userRequirements||"",b.value=l.currentStep||0,l.projectId))try{U.value=await H.stats(l.projectId),await le(),await ae(),await Re()}catch(e){console.error("Failed to restore state:",e)}g.currentTask&&g.currentTask.status==="running"&&(A.value=!0,z.value=g.currentTask.message,x.value=g.currentTask.progress,g.currentTask.type==="test_cases"&&ls())},ls=()=>{const l=()=>{if(!g.currentTask||g.currentTask.status!=="running"){A.value=!1;return}z.value=g.currentTask.message,x.value=g.currentTask.progress,g.currentTask.status==="running"?setTimeout(l,1e3):g.currentTask.status==="completed"?(A.value=!1,g.currentTask.result&&(I.value=g.currentTask.result,f.success("测试用例生成完成"))):g.currentTask.status==="failed"&&(A.value=!1,f.error(g.currentTask.error||"生成失败"))};l()};return ds(async()=>{await gt();const l=new URLSearchParams(window.location.search),e=l.get("project_id");if(l.get("reset")==="true"||e){if(et(),e){v.projectId=e,b.value=1;try{U.value=await H.stats(e),await le(),await ae()}catch(n){console.error("Failed to load project data:",n)}}}else ss()}),ps(()=>{Ve()}),cs([b,v,$,I,N],()=>{Ve()},{deep:!0}),(l,e)=>{var lt;const i=fs,n=Gs,y=Ts,m=Fs,O=js,J=Vs,oe=ms,qe=_s,je=Ss,Ie=Is,as=ys,tt=gs,_=ks,os=bs,h=Ds,ns=ws,is=xs,Z=Ms,L=Bs,st=Ns,ne=Cs;return d(),w("div",Ws,[e[116]||(e[116]=o("div",{class:"page-header"},[o("div",{class:"header-content"},[o("h1",{class:"page-title"},"AI生成测试用例"),o("p",{class:"page-subtitle"},"智能化测试用例生成流程")])],-1)),o("div",Zs,[(d(),w(Y,null,ee(xe,(a,r)=>o("div",{key:r,class:K(["step-item",{"is-active":b.value===r,"is-finished":b.value>r,"is-clickable":v.projectId||r===0}]),onClick:F=>St(r)},[o("div",Ys,[b.value>r?(d(),V(i,{key:0},{default:s(()=>[t(c(Q))]),_:1})):(d(),w("span",el,p(r+1),1))]),o("div",tl,p(a),1),r<xe.length-1?(d(),w("div",sl)):G("",!0)],10,Qs)),64))]),o("div",ll,[o("div",al,[ye(o("div",ol,[t(oe,{model:v,"label-width":"100px"},{default:s(()=>[t(m,{label:"选择项目"},{default:s(()=>[t(y,{modelValue:v.projectId,"onUpdate:modelValue":e[0]||(e[0]=a=>v.projectId=a),placeholder:"请选择项目",style:{width:"100%"},onChange:kt},{default:s(()=>[(d(!0),w(Y,null,ee(W.value,a=>(d(),V(n,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"测试类型"},{default:s(()=>[t(J,{modelValue:v.testTypes,"onUpdate:modelValue":e[1]||(e[1]=a=>v.testTypes=a)},{default:s(()=>[t(O,{label:"functional"},{default:s(()=>[...e[34]||(e[34]=[u("功能测试",-1)])]),_:1}),t(O,{label:"performance"},{default:s(()=>[...e[35]||(e[35]=[u("性能测试",-1)])]),_:1}),t(O,{label:"security"},{default:s(()=>[...e[36]||(e[36]=[u("安全测试",-1)])]),_:1}),t(O,{label:"reliability"},{default:s(()=>[...e[37]||(e[37]=[u("可靠性测试",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),U.value&&v.projectId?(d(),w("div",nl,[t(qe,null,{default:s(()=>[...e[38]||(e[38]=[u("项目统计信息",-1)])]),_:1}),t(as,{gutter:20},{default:s(()=>[t(Ie,{span:6},{default:s(()=>[t(je,{title:"已上传文档",value:U.value.document_count},{suffix:s(()=>[...e[39]||(e[39]=[o("span",{style:{"font-size":"14px"}},"个",-1)])]),_:1},8,["value"])]),_:1}),t(Ie,{span:6},{default:s(()=>[t(je,{title:"已解析文档",value:U.value.parsed_document_count},{suffix:s(()=>[...e[40]||(e[40]=[o("span",{style:{"font-size":"14px"}},"个",-1)])]),_:1},8,["value"])]),_:1}),t(Ie,{span:6},{default:s(()=>[t(je,{title:"测试功能点",value:U.value.function_point_count},{suffix:s(()=>[...e[41]||(e[41]=[o("span",{style:{"font-size":"14px"}},"个",-1)])]),_:1},8,["value"])]),_:1}),t(Ie,{span:6},{default:s(()=>[t(je,{title:"测试用例",value:U.value.test_case_count},{suffix:s(()=>[...e[42]||(e[42]=[o("span",{style:{"font-size":"14px"}},"个",-1)])]),_:1},8,["value"])]),_:1})]),_:1})])):G("",!0)],512),[[ge,b.value===0]]),ye(o("div",il,[P.value.length>0?(d(),w("div",ul,[t(tt,{type:"success",closable:!1,"show-icon":"",style:{"margin-bottom":"16px"}},{title:s(()=>[o("span",null,[e[43]||(e[43]=u("该项目已有 ",-1)),o("strong",null,p(P.value.length),1),e[44]||(e[44]=u(" 个文档",-1))])]),_:1}),o("div",rl,[(d(!0),w(Y,null,ee(P.value,a=>(d(),w("div",{key:a.id,class:"document-item"},[o("div",dl,[t(i,null,{default:s(()=>[t(c(ke))]),_:1})]),o("div",pl,[o("div",cl,p(a.name),1),o("div",vl,[o("span",fl,p(mt(a.doc_type)),1),o("span",ml,p(xt(a.file_size)),1),o("span",_l,p(yt(a.created_at)),1)])]),o("div",{class:K(["doc-status",a.status])},p(_t(a.status)),3),o("div",yl,[t(_,{type:"primary",text:"",size:"small",onClick:r=>Ct()},{default:s(()=>[t(i,null,{default:s(()=>[t(c(Le))]),_:1}),e[45]||(e[45]=u(" 查看 ",-1))]),_:1},8,["onClick"]),t(_,{type:"warning",text:"",size:"small",onClick:r=>Ft(a),disabled:a.status==="parsed"},{default:s(()=>[t(i,null,{default:s(()=>[t(c(Es))]),_:1}),e[46]||(e[46]=u(" 重解析 ",-1))]),_:1},8,["onClick","disabled"]),t(_,{type:"danger",text:"",size:"small",onClick:r=>Tt(a)},{default:s(()=>[t(i,null,{default:s(()=>[t(c(Ne))]),_:1}),e[47]||(e[47]=u(" 删除 ",-1))]),_:1},8,["onClick"])])]))),128))]),t(qe,null,{default:s(()=>[...e[48]||(e[48]=[u("继续上传新文档",-1)])]),_:1})])):G("",!0),t(os,{class:"upload-area",drag:"",multiple:"","file-list":C.value,"auto-upload":!1,"on-change":bt,"on-remove":wt},{tip:s(()=>[...e[49]||(e[49]=[o("div",{class:"el-upload__tip"}," 支持 PDF、Word、Markdown、TXT 等格式文档 ",-1)])]),default:s(()=>[t(i,{class:"el-icon--upload"},{default:s(()=>[t(c(Ps))]),_:1}),e[50]||(e[50]=o("div",{class:"el-upload__text"},[u(" 拖拽文件到此处或 "),o("em",null,"点击上传")],-1))]),_:1},8,["file-list"]),t(qe,null,{default:s(()=>[...e[51]||(e[51]=[u("或者",-1)])]),_:1}),t(oe,{"label-width":"auto"},{default:s(()=>[t(m,null,{label:s(()=>[...e[52]||(e[52]=[o("span",{class:"form-label"},"需求描述",-1)])]),default:s(()=>[t(h,{modelValue:v.userRequirements,"onUpdate:modelValue":e[2]||(e[2]=a=>v.userRequirements=a),type:"textarea",rows:5,placeholder:`请输入您的测试需求描述，例如：
- 测试用户登录功能
- 测试API接口响应时间
- 测试数据安全性`,class:"full-width-textarea"},null,8,["modelValue"])]),_:1})]),_:1})],512),[[ge,b.value===1]]),ye(o("div",gl,[X.value?(d(),w("div",kl,[t(i,{class:"is-loading",size:40},{default:s(()=>[t(c(Us))]),_:1}),o("p",null,p(z.value),1),t(ns,{percentage:x.value,"stroke-width":8,style:{width:"300px","margin-top":"20px"}},null,8,["percentage"])])):(d(),w("div",bl,[o("div",wl,[o("span",null,"功能点列表 ("+p(M.value.length)+" 个)",1),o("div",xl,[t(_,{type:"primary",onClick:Xe,loading:A.value},{default:s(()=>[t(i,null,{default:s(()=>[t(c(ie))]),_:1}),e[53]||(e[53]=u(" AI辅助生成 ",-1))]),_:1},8,["loading"]),t(_,{onClick:Jt},{default:s(()=>[t(i,null,{default:s(()=>[t(c(at))]),_:1}),e[54]||(e[54]=u(" 添加功能点 ",-1))]),_:1})])]),M.value.length===0?(d(),w("div",Cl,[t(is,{description:"暂无功能点，请点击「AI辅助生成」或「添加功能点」"},{default:s(()=>[t(_,{type:"primary",onClick:Xe,loading:A.value},{default:s(()=>[t(i,null,{default:s(()=>[t(c(ie))]),_:1}),e[55]||(e[55]=u(" AI辅助生成 ",-1))]),_:1},8,["loading"])]),_:1})])):(d(),w("div",Fl,[(d(!0),w(Y,null,ee(M.value,(a,r)=>{var F;return d(),w("div",{key:r,class:K(["function-point-item",{editing:a.editing}])},[o("div",{class:K(["fp-icon",a.test_type])},[a.test_type==="functional"?(d(),V(i,{key:0},{default:s(()=>[t(c(ke))]),_:1})):a.test_type==="performance"?(d(),V(i,{key:1},{default:s(()=>[t(c(Be))]),_:1})):a.test_type==="security"?(d(),V(i,{key:2},{default:s(()=>[t(c(Me))]),_:1})):(d(),V(i,{key:3},{default:s(()=>[t(c(Ge))]),_:1}))],2),o("div",Tl,[o("div",Vl,[u(p(a.name)+" ",1),a.isExisting?(d(),V(Z,{key:0,type:"info",size:"small",style:{"margin-left":"8px"}},{default:s(()=>[...e[56]||(e[56]=[u("已有",-1)])]),_:1})):a.isNew?(d(),V(Z,{key:1,type:"success",size:"small",style:{"margin-left":"8px"}},{default:s(()=>[...e[57]||(e[57]=[u("新增",-1)])]),_:1})):G("",!0)]),o("div",jl,[o("span",Il,p(_e(a.test_type)),1),o("span",Sl,p((F=a.priority)==null?void 0:F.toUpperCase()),1),o("span",El,p(a.module||"-"),1)])]),o("div",{class:K(["fp-status",a.status])},p(a.status==="approved"?"已审核":a.status==="rejected"?"已拒绝":"待审核"),3),o("div",Pl,[t(_,{type:"primary",text:"",size:"small",onClick:R=>Gt(a)},{default:s(()=>[t(i,null,{default:s(()=>[t(c(Le))]),_:1}),e[58]||(e[58]=u(" 查看 ",-1))]),_:1},8,["onClick"]),t(_,{type:"primary",text:"",size:"small",onClick:R=>ht(a)},{default:s(()=>[t(i,null,{default:s(()=>[t(c($s))]),_:1}),e[59]||(e[59]=u(" 编辑 ",-1))]),_:1},8,["onClick"]),a.isExisting?G("",!0):(d(),V(_,{key:0,type:"warning",text:"",size:"small",onClick:R=>Ot(a)},{default:s(()=>[t(i,null,{default:s(()=>[t(c(ie))]),_:1}),e[60]||(e[60]=u(" AI优化 ",-1))]),_:1},8,["onClick"])),t(_,{type:"success",text:"",size:"small",onClick:R=>Lt(a),disabled:a.status==="approved"},{default:s(()=>[t(i,null,{default:s(()=>[t(c(Q))]),_:1}),e[61]||(e[61]=u(" 通过 ",-1))]),_:1},8,["onClick","disabled"]),t(_,{type:"warning",text:"",size:"small",onClick:R=>Nt(a),disabled:a.status==="rejected"},{default:s(()=>[t(i,null,{default:s(()=>[t(c(be))]),_:1}),e[62]||(e[62]=u(" 拒绝 ",-1))]),_:1},8,["onClick","disabled"]),t(_,{type:"danger",text:"",size:"small",onClick:R=>l.deleteFunctionPoint(a)},{default:s(()=>[t(i,null,{default:s(()=>[t(c(Ne))]),_:1}),e[63]||(e[63]=u(" 删除 ",-1))]),_:1},8,["onClick"])])],2)}),128))]))]))],512),[[ge,b.value===2]]),ye(o("div",Dl,[o("div",Ul,[t(tt,{type:"info",closable:!1,"show-icon":""},{title:s(()=>[o("span",null,[e[64]||(e[64]=u("请审核以下 ",-1)),o("strong",null,p(M.value.length),1),e[65]||(e[65]=u(" 个功能点，已审核通过 ",-1)),o("strong",null,p(ze.value),1),e[66]||(e[66]=u(" 个，确认后继续生成测试用例",-1))])]),_:1})]),o("div",$l,[t(_,{type:"success",onClick:Bt,disabled:Ae.value===0},{default:s(()=>[t(i,null,{default:s(()=>[t(c(Q))]),_:1}),u(" 全部通过 ("+p(Ae.value)+" 个待审核) ",1)]),_:1},8,["disabled"]),t(_,{type:"danger",onClick:Mt,disabled:Ae.value===0},{default:s(()=>[t(i,null,{default:s(()=>[t(c(be))]),_:1}),e[67]||(e[67]=u(" 全部拒绝 ",-1))]),_:1},8,["disabled"])]),M.value.length>0?(d(),w("div",zl,[(d(!0),w(Y,null,ee(M.value,(a,r)=>{var F;return d(),w("div",{key:r,class:"function-point-item"},[o("div",{class:K(["fp-icon",a.test_type])},[a.test_type==="functional"?(d(),V(i,{key:0},{default:s(()=>[t(c(ke))]),_:1})):a.test_type==="performance"?(d(),V(i,{key:1},{default:s(()=>[t(c(Be))]),_:1})):a.test_type==="security"?(d(),V(i,{key:2},{default:s(()=>[t(c(Me))]),_:1})):(d(),V(i,{key:3},{default:s(()=>[t(c(Ge))]),_:1}))],2),o("div",Al,[o("div",hl,[u(p(a.name)+" ",1),a.isExisting?(d(),V(Z,{key:0,type:"info",size:"small",style:{"margin-left":"8px"}},{default:s(()=>[...e[68]||(e[68]=[u("已有",-1)])]),_:1})):a.isNew?(d(),V(Z,{key:1,type:"success",size:"small",style:{"margin-left":"8px"}},{default:s(()=>[...e[69]||(e[69]=[u("新增",-1)])]),_:1})):G("",!0)]),o("div",Rl,[o("span",ql,p(_e(a.test_type)),1),o("span",Ll,p((F=a.priority)==null?void 0:F.toUpperCase()),1),o("span",Nl,p(a.module||"-"),1)])]),o("div",{class:K(["fp-status",a.status])},p(a.status==="approved"?"已审核":a.status==="rejected"?"已拒绝":"待审核"),3),o("div",Bl,[t(_,{type:"success",text:"",size:"small",onClick:R=>Ye(a,"approved"),disabled:a.status==="approved"},{default:s(()=>[t(i,null,{default:s(()=>[t(c(Q))]),_:1}),e[70]||(e[70]=u(" 通过 ",-1))]),_:1},8,["onClick","disabled"]),t(_,{type:"danger",text:"",size:"small",onClick:R=>Ye(a,"rejected"),disabled:a.status==="rejected"},{default:s(()=>[t(i,null,{default:s(()=>[t(c(be))]),_:1}),e[71]||(e[71]=u(" 拒绝 ",-1))]),_:1},8,["onClick","disabled"])])])}),128))])):G("",!0),o("div",Ml,[t(_,{onClick:e[3]||(e[3]=a=>b.value=2)},{default:s(()=>[t(i,null,{default:s(()=>[t(c(zs))]),_:1}),e[72]||(e[72]=u(" 返回修改 ",-1))]),_:1}),t(_,{type:"primary",onClick:Pt,disabled:ze.value===0},{default:s(()=>[u(" 确认并生成测试用例 ("+p(ze.value)+" 个) ",1),t(i,null,{default:s(()=>[t(c(As))]),_:1})]),_:1},8,["disabled"])])],512),[[ge,b.value===3]]),ye(o("div",Gl,[X.value?(d(),w("div",Ol,[o("div",Hl,[e[73]||(e[73]=o("div",{class:"pulse-circle"},null,-1)),e[74]||(e[74]=o("div",{class:"pulse-circle"},null,-1)),e[75]||(e[75]=o("div",{class:"pulse-circle"},null,-1)),o("div",Jl,[t(i,null,{default:s(()=>[t(c(ie))]),_:1})])]),o("div",Kl,[o("div",Xl,p(x.value)+"%",1),o("div",Wl,p(z.value),1),o("div",Zl,[o("div",{class:"progress-bar-fill",style:vs({width:x.value+"%"})},null,4)])]),o("div",Ql,[o("span",Yl,p(es.value),1)])])):(d(),w("div",ea,[o("div",ta,[o("div",sa,[t(i,null,{default:s(()=>[t(c(hs))]),_:1})]),o("div",la,[e[76]||(e[76]=u(" 已确认 ",-1)),o("strong",null,p(N.value.length||q.value.length),1),e[77]||(e[77]=u(" 个功能点，可用于生成测试用例 ",-1))])]),o("div",aa,[o("div",oa,[e[78]||(e[78]=o("span",{class:"list-title"},"测试用例列表",-1)),o("span",na,p(I.value.length)+" 个",1)]),o("div",ia,[t(_,{type:"primary",class:"ai-btn",onClick:We,loading:A.value},{default:s(()=>[t(i,null,{default:s(()=>[t(c(ie))]),_:1}),e[79]||(e[79]=u(" AI智能生成 ",-1))]),_:1},8,["loading"]),t(_,{onClick:Xt},{default:s(()=>[t(i,null,{default:s(()=>[t(c(at))]),_:1}),e[80]||(e[80]=u(" 手动添加 ",-1))]),_:1})])]),I.value.length===0?(d(),w("div",ua,[o("div",ra,[t(i,null,{default:s(()=>[t(c(Rs))]),_:1})]),e[82]||(e[82]=o("p",{class:"empty-title"},"暂无测试用例",-1)),e[83]||(e[83]=o("p",{class:"empty-desc"},"点击下方按钮，AI将根据功能点自动生成测试用例",-1)),t(_,{type:"primary",size:"large",class:"empty-btn",onClick:We,loading:A.value},{default:s(()=>[t(i,null,{default:s(()=>[t(c(ie))]),_:1}),e[81]||(e[81]=u(" AI智能生成 ",-1))]),_:1},8,["loading"])])):(d(),w("div",da,[(d(!0),w(Y,null,ee(I.value,(a,r)=>{var F;return d(),w("div",{key:r,class:"testcase-item"},[o("div",{class:K(["testcase-icon",a.test_type])},[a.test_type==="functional"?(d(),V(i,{key:0},{default:s(()=>[t(c(ke))]),_:1})):a.test_type==="performance"?(d(),V(i,{key:1},{default:s(()=>[t(c(Be))]),_:1})):a.test_type==="security"?(d(),V(i,{key:2},{default:s(()=>[t(c(Me))]),_:1})):(d(),V(i,{key:3},{default:s(()=>[t(c(Ge))]),_:1}))],2),o("div",pa,[o("div",ca,p(a.title),1),o("div",va,[o("span",fa,p(_e(a.test_type)),1),o("span",ma,p((F=a.priority)==null?void 0:F.toUpperCase()),1)])]),o("div",{class:K(["testcase-status",a.status||"draft"])},p(Ke(a.status)),3),o("div",_a,[t(_,{type:"primary",text:"",size:"small",onClick:R=>Zt(a)},{default:s(()=>[t(i,null,{default:s(()=>[t(c(Le))]),_:1}),e[84]||(e[84]=u(" 查看 ",-1))]),_:1},8,["onClick"]),t(_,{type:"success",text:"",size:"small",onClick:R=>Ut(a),disabled:a.status==="approved"},{default:s(()=>[t(i,null,{default:s(()=>[t(c(Q))]),_:1}),e[85]||(e[85]=u(" 通过 ",-1))]),_:1},8,["onClick","disabled"]),t(_,{type:"warning",text:"",size:"small",onClick:R=>$t(a),disabled:a.status==="approved"||a.status==="rejected"},{default:s(()=>[t(i,null,{default:s(()=>[t(c(be))]),_:1}),e[86]||(e[86]=u(" 拒绝 ",-1))]),_:1},8,["onClick","disabled"]),t(_,{type:"danger",text:"",size:"small",onClick:R=>ts(r)},{default:s(()=>[t(i,null,{default:s(()=>[t(c(Ne))]),_:1}),e[87]||(e[87]=u(" 删除 ",-1))]),_:1},8,["onClick"])])])}),128))])),I.value.length>0?(d(),w("div",ya,[o("div",ga,[e[94]||(e[94]=o("div",{class:"summary-title"},"审核统计",-1)),o("div",ka,[o("div",ba,[o("span",wa,[t(i,null,{default:s(()=>[t(c(ke))]),_:1})]),o("span",null,[e[88]||(e[88]=u("总计 ",-1)),o("span",xa,p(I.value.length),1),e[89]||(e[89]=u(" 个",-1))])]),o("div",Ca,[o("span",Fa,[t(i,null,{default:s(()=>[t(c(Q))]),_:1})]),o("span",null,[e[90]||(e[90]=u("已通过 ",-1)),o("span",Ta,p(he.value),1),e[91]||(e[91]=u(" 个",-1))])]),o("div",Va,[o("span",ja,[t(i,null,{default:s(()=>[t(c(qs))]),_:1})]),o("span",null,[e[92]||(e[92]=u("待审核 ",-1)),o("span",Ia,p(Je.value),1),e[93]||(e[93]=u(" 个",-1))])])])]),o("div",Sa,[t(_,{type:"success",size:"large",onClick:zt,disabled:Je.value===0},{default:s(()=>[t(i,null,{default:s(()=>[t(c(Q))]),_:1}),e[95]||(e[95]=u(" 全部通过 ",-1))]),_:1},8,["disabled"]),t(_,{type:"primary",size:"large",onClick:Dt,loading:de.value,disabled:he.value===0},{default:s(()=>[t(i,null,{default:s(()=>[t(c(Ls))]),_:1}),u(" 保存已通过 ("+p(he.value)+") ",1)]),_:1},8,["loading","disabled"])])])):G("",!0)]))],512),[[ge,b.value===4]])]),b.value<4||b.value===4&&!X.value?(d(),w("div",Ea,[b.value>0&&b.value!==3?(d(),V(_,{key:0,onClick:Vt},{default:s(()=>[...e[96]||(e[96]=[u("上一步",-1)])]),_:1})):G("",!0),b.value<2?(d(),V(_,{key:1,type:"primary",onClick:jt,disabled:!nt.value},{default:s(()=>[...e[97]||(e[97]=[u(" 下一步 ",-1)])]),_:1},8,["disabled"])):G("",!0),b.value===2&&M.value.length>0?(d(),V(_,{key:2,type:"primary",onClick:Et},{default:s(()=>[...e[98]||(e[98]=[u(" 下一步：审核确认 ",-1)])]),_:1})):G("",!0)])):G("",!0)]),t(ne,{modelValue:Fe.value,"onUpdate:modelValue":e[5]||(e[5]=a=>Fe.value=a),title:"查看功能点",width:"600px"},{footer:s(()=>[t(_,{onClick:e[4]||(e[4]=a=>Fe.value=!1)},{default:s(()=>[...e[101]||(e[101]=[u("关闭",-1)])]),_:1})]),default:s(()=>[t(st,{column:2,border:""},{default:s(()=>[t(L,{label:"功能点名称"},{default:s(()=>{var a;return[u(p((a=B.value)==null?void 0:a.name),1)]}),_:1}),t(L,{label:"测试类型"},{default:s(()=>{var a;return[t(Z,{type:vt((a=B.value)==null?void 0:a.test_type)},{default:s(()=>{var r;return[u(p(_e((r=B.value)==null?void 0:r.test_type)),1)]}),_:1},8,["type"])]}),_:1}),t(L,{label:"优先级"},{default:s(()=>{var a;return[t(Z,{type:ft((a=B.value)==null?void 0:a.priority)},{default:s(()=>{var r,F;return[u(p((F=(r=B.value)==null?void 0:r.priority)==null?void 0:F.toUpperCase()),1)]}),_:1},8,["type"])]}),_:1}),t(L,{label:"状态"},{default:s(()=>{var a,r;return[t(Z,{type:((a=B.value)==null?void 0:a.status)==="approved"?"success":((r=B.value)==null?void 0:r.status)==="rejected"?"danger":"warning"},{default:s(()=>{var F,R;return[u(p(((F=B.value)==null?void 0:F.status)==="approved"?"已审核":((R=B.value)==null?void 0:R.status)==="rejected"?"已拒绝":"待审核"),1)]}),_:1},8,["type"])]}),_:1}),t(L,{label:"模块",span:2},{default:s(()=>{var a;return[u(p(((a=B.value)==null?void 0:a.module)||"-"),1)]}),_:1}),t(L,{label:"描述",span:2},{default:s(()=>{var a;return[u(p(((a=B.value)==null?void 0:a.description)||"-"),1)]}),_:1}),t(L,{label:"来源",span:2},{default:s(()=>{var a;return[(a=B.value)!=null&&a.isExisting?(d(),V(Z,{key:0,type:"info"},{default:s(()=>[...e[99]||(e[99]=[u("已有",-1)])]),_:1})):(d(),V(Z,{key:1,type:"success"},{default:s(()=>[...e[100]||(e[100]=[u("新增",-1)])]),_:1}))]}),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ne,{modelValue:ce.value,"onUpdate:modelValue":e[8]||(e[8]=a=>ce.value=a),title:"AI优化功能点",width:"500px"},{footer:s(()=>[t(_,{onClick:e[7]||(e[7]=a=>ce.value=!1)},{default:s(()=>[...e[102]||(e[102]=[u("取消",-1)])]),_:1}),t(_,{type:"primary",onClick:Ht,loading:Ee.value},{default:s(()=>[...e[103]||(e[103]=[u("优化",-1)])]),_:1},8,["loading"])]),default:s(()=>[t(oe,{"label-width":"80px"},{default:s(()=>[t(m,{label:"功能点"},{default:s(()=>{var a;return[t(h,{"model-value":(a=Pe.value)==null?void 0:a.name,disabled:""},null,8,["model-value"])]}),_:1}),t(m,{label:"优化建议"},{default:s(()=>[t(h,{modelValue:ve.value,"onUpdate:modelValue":e[6]||(e[6]=a=>ve.value=a),type:"textarea",rows:4,placeholder:`请输入您的优化建议，例如：
- 增加异常场景测试
- 调整优先级为P0
- 补充验收标准`},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ne,{modelValue:fe.value,"onUpdate:modelValue":e[16]||(e[16]=a=>fe.value=a),title:"添加功能点",width:"500px"},{footer:s(()=>[t(_,{onClick:e[15]||(e[15]=a=>fe.value=!1)},{default:s(()=>[...e[104]||(e[104]=[u("取消",-1)])]),_:1}),t(_,{type:"primary",onClick:Kt},{default:s(()=>[...e[105]||(e[105]=[u("添加",-1)])]),_:1})]),default:s(()=>[t(oe,{model:S,"label-width":"80px"},{default:s(()=>[t(m,{label:"名称",required:""},{default:s(()=>[t(h,{modelValue:S.name,"onUpdate:modelValue":e[9]||(e[9]=a=>S.name=a),placeholder:"请输入功能点名称"},null,8,["modelValue"])]),_:1}),t(m,{label:"描述"},{default:s(()=>[t(h,{modelValue:S.description,"onUpdate:modelValue":e[10]||(e[10]=a=>S.description=a),type:"textarea",rows:2,placeholder:"请输入功能点描述"},null,8,["modelValue"])]),_:1}),t(m,{label:"测试类型"},{default:s(()=>[t(y,{modelValue:S.test_type,"onUpdate:modelValue":e[11]||(e[11]=a=>S.test_type=a),style:{width:"100%"}},{default:s(()=>[t(n,{label:"功能测试",value:"functional"}),t(n,{label:"性能测试",value:"performance"}),t(n,{label:"安全测试",value:"security"}),t(n,{label:"可靠性测试",value:"reliability"})]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"优先级"},{default:s(()=>[t(y,{modelValue:S.priority,"onUpdate:modelValue":e[12]||(e[12]=a=>S.priority=a),style:{width:"100%"}},{default:s(()=>[t(n,{label:"P0 - 核心",value:"p0"}),t(n,{label:"P1 - 重要",value:"p1"}),t(n,{label:"P2 - 一般",value:"p2"}),t(n,{label:"P3 - 次要",value:"p3"}),t(n,{label:"P4 - 边缘",value:"p4"})]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"模块"},{default:s(()=>[t(h,{modelValue:S.module,"onUpdate:modelValue":e[13]||(e[13]=a=>S.module=a),placeholder:"请输入所属模块"},null,8,["modelValue"])]),_:1}),t(m,{label:"验收标准"},{default:s(()=>[t(h,{modelValue:S.acceptance_criteria,"onUpdate:modelValue":e[14]||(e[14]=a=>S.acceptance_criteria=a),type:"textarea",rows:2,placeholder:"请输入验收标准"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t(ne,{modelValue:Te.value,"onUpdate:modelValue":e[23]||(e[23]=a=>Te.value=a),title:De.value?"编辑功能点":"新增功能点",width:"600px"},{footer:s(()=>[t(_,{onClick:qt},{default:s(()=>[...e[106]||(e[106]=[u("取消",-1)])]),_:1}),t(_,{type:"primary",onClick:Rt},{default:s(()=>[...e[107]||(e[107]=[u("确定",-1)])]),_:1})]),default:s(()=>[t(oe,{model:T,"label-width":"100px",rules:ot,ref_key:"editFpFormRef",ref:$e},{default:s(()=>[t(m,{label:"功能点名称",prop:"name"},{default:s(()=>[t(h,{modelValue:T.name,"onUpdate:modelValue":e[17]||(e[17]=a=>T.name=a),placeholder:"请输入功能点名称"},null,8,["modelValue"])]),_:1}),t(m,{label:"描述",prop:"description"},{default:s(()=>[t(h,{modelValue:T.description,"onUpdate:modelValue":e[18]||(e[18]=a=>T.description=a),type:"textarea",rows:3,placeholder:"请输入功能点描述"},null,8,["modelValue"])]),_:1}),t(m,{label:"测试类型",prop:"test_type"},{default:s(()=>[t(y,{modelValue:T.test_type,"onUpdate:modelValue":e[19]||(e[19]=a=>T.test_type=a),placeholder:"请选择测试类型",style:{width:"100%"}},{default:s(()=>[t(n,{label:"功能测试",value:"functional"}),t(n,{label:"性能测试",value:"performance"}),t(n,{label:"安全测试",value:"security"}),t(n,{label:"可靠性测试",value:"reliability"})]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"优先级",prop:"priority"},{default:s(()=>[t(y,{modelValue:T.priority,"onUpdate:modelValue":e[20]||(e[20]=a=>T.priority=a),placeholder:"请选择优先级",style:{width:"100%"}},{default:s(()=>[t(n,{label:"P0 - 最高",value:"p0"}),t(n,{label:"P1 - 高",value:"p1"}),t(n,{label:"P2 - 中",value:"p2"}),t(n,{label:"P3 - 低",value:"p3"}),t(n,{label:"P4 - 最低",value:"p4"})]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"模块",prop:"module"},{default:s(()=>[t(h,{modelValue:T.module,"onUpdate:modelValue":e[21]||(e[21]=a=>T.module=a),placeholder:"请输入所属模块"},null,8,["modelValue"])]),_:1}),t(m,{label:"验收标准",prop:"acceptance_criteria"},{default:s(()=>[t(h,{modelValue:T.acceptance_criteria,"onUpdate:modelValue":e[22]||(e[22]=a=>T.acceptance_criteria=a),type:"textarea",rows:3,placeholder:"请输入验收标准"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(ne,{modelValue:me.value,"onUpdate:modelValue":e[31]||(e[31]=a=>me.value=a),title:"添加测试用例",width:"600px"},{footer:s(()=>[t(_,{onClick:e[30]||(e[30]=a=>me.value=!1)},{default:s(()=>[...e[108]||(e[108]=[u("取消",-1)])]),_:1}),t(_,{type:"primary",onClick:Wt},{default:s(()=>[...e[109]||(e[109]=[u("添加",-1)])]),_:1})]),default:s(()=>[t(oe,{model:E,"label-width":"80px"},{default:s(()=>[t(m,{label:"标题",required:""},{default:s(()=>[t(h,{modelValue:E.title,"onUpdate:modelValue":e[24]||(e[24]=a=>E.title=a),placeholder:"请输入测试用例标题"},null,8,["modelValue"])]),_:1}),t(m,{label:"描述"},{default:s(()=>[t(h,{modelValue:E.description,"onUpdate:modelValue":e[25]||(e[25]=a=>E.description=a),type:"textarea",rows:2,placeholder:"请输入测试用例描述"},null,8,["modelValue"])]),_:1}),t(m,{label:"测试类型"},{default:s(()=>[t(y,{modelValue:E.test_type,"onUpdate:modelValue":e[26]||(e[26]=a=>E.test_type=a),style:{width:"100%"}},{default:s(()=>[t(n,{label:"功能测试",value:"functional"}),t(n,{label:"性能测试",value:"performance"}),t(n,{label:"安全测试",value:"security"}),t(n,{label:"可靠性测试",value:"reliability"})]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"优先级"},{default:s(()=>[t(y,{modelValue:E.priority,"onUpdate:modelValue":e[27]||(e[27]=a=>E.priority=a),style:{width:"100%"}},{default:s(()=>[t(n,{label:"P0",value:"p0"}),t(n,{label:"P1",value:"p1"}),t(n,{label:"P2",value:"p2"}),t(n,{label:"P3",value:"p3"})]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"前置条件"},{default:s(()=>[t(h,{modelValue:E.preconditions,"onUpdate:modelValue":e[28]||(e[28]=a=>E.preconditions=a),type:"textarea",rows:2,placeholder:"请输入前置条件"},null,8,["modelValue"])]),_:1}),t(m,{label:"预期结果"},{default:s(()=>[t(h,{modelValue:E.expected_results,"onUpdate:modelValue":e[29]||(e[29]=a=>E.expected_results=a),type:"textarea",rows:2,placeholder:"请输入预期结果"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t(ne,{modelValue:Ce.value,"onUpdate:modelValue":e[33]||(e[33]=a=>Ce.value=a),title:(lt=D.value)==null?void 0:lt.title,width:"720px",class:"tc-detail-dialog"},{footer:s(()=>{var a,r,F;return[o("div",Ra,[t(_,{onClick:e[32]||(e[32]=R=>Ce.value=!1)},{default:s(()=>[...e[113]||(e[113]=[u("关闭",-1)])]),_:1}),t(_,{type:"success",onClick:Qt,disabled:((a=D.value)==null?void 0:a.status)==="approved"},{default:s(()=>[t(i,null,{default:s(()=>[t(c(Q))]),_:1}),e[114]||(e[114]=u(" 通过审核 ",-1))]),_:1},8,["disabled"]),t(_,{type:"danger",onClick:Yt,disabled:((r=D.value)==null?void 0:r.status)==="approved"||((F=D.value)==null?void 0:F.status)==="rejected"},{default:s(()=>[t(i,null,{default:s(()=>[t(c(be))]),_:1}),e[115]||(e[115]=u(" 拒绝 ",-1))]),_:1},8,["disabled"])])]}),default:s(()=>{var a;return[t(st,{column:2,border:""},{default:s(()=>[t(L,{label:"测试类型"},{default:s(()=>{var r;return[u(p(_e((r=D.value)==null?void 0:r.test_type)),1)]}),_:1}),t(L,{label:"优先级"},{default:s(()=>{var r,F;return[u(p((F=(r=D.value)==null?void 0:r.priority)==null?void 0:F.toUpperCase()),1)]}),_:1}),t(L,{label:"测试分类"},{default:s(()=>{var r;return[u(p(((r=D.value)==null?void 0:r.test_category)||"-"),1)]}),_:1}),t(L,{label:"状态"},{default:s(()=>{var r,F;return[o("span",{class:K(["status-text",((r=D.value)==null?void 0:r.status)||"draft"])},p(Ke((F=D.value)==null?void 0:F.status)),3)]}),_:1}),t(L,{label:"前置条件",span:2},{default:s(()=>{var r;return[u(p(((r=D.value)==null?void 0:r.preconditions)||"-"),1)]}),_:1}),t(L,{label:"描述",span:2},{default:s(()=>{var r;return[u(p(((r=D.value)==null?void 0:r.description)||"-"),1)]}),_:1}),t(L,{label:"预期结果",span:2},{default:s(()=>{var r;return[u(p(((r=D.value)==null?void 0:r.expected_results)||"-"),1)]}),_:1})]),_:1}),Array.isArray((a=D.value)==null?void 0:a.test_steps)&&D.value.test_steps.length>0?(d(),w("div",Pa,[e[111]||(e[111]=o("h4",null,"测试步骤",-1)),o("div",Da,[(d(!0),w(Y,null,ee(D.value.test_steps,(r,F)=>(d(),w("div",{key:F,class:"step-item"},[o("div",Ua,p(r.step_num||F+1),1),o("div",$a,[o("div",za,p(r.action),1),r.expected_result?(d(),w("div",Aa,[e[110]||(e[110]=o("span",{class:"expected-label"},"预期:",-1)),u(" "+p(r.expected_result),1)])):G("",!0)])]))),128))])])):(d(),w("div",ha,[t(i,null,{default:s(()=>[t(c(Os))]),_:1}),e[112]||(e[112]=o("span",null,"暂无测试步骤",-1))]))]}),_:1},8,["modelValue","title"])])}}}),Xa=Ks(qa,[["__scopeId","data-v-5f68e886"]]);export{Xa as default};
